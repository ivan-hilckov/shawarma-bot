# ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Shawarma Bot.

---

## üìã –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

---

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

#### Telegram Bot

```env
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather
BOT_TOKEN=1234567890:ABCdefGHIjklmnoPQRstuvwxyz

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: ID —á–∞—Ç–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º
NOTIFICATIONS_CHAT_ID=-1001234567890

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
ADMIN_USER_IDS=123456789,987654321
```

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```env
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
DATABASE_URL=postgresql://user:password@host:port/database

# –ü—Ä–∏–º–µ—Ä –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
DATABASE_URL=postgresql://shawarma_user:shawarma_pass@localhost:5432/shawarma_db

# –ü—Ä–∏–º–µ—Ä –¥–ª—è Docker
DATABASE_URL=postgresql://shawarma_user:shawarma_pass@postgres:5432/shawarma_db
```

#### Redis

```env
# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
REDIS_URL=redis://localhost:6379

# –° –ø–∞—Ä–æ–ª–µ–º
REDIS_URL=redis://:password@localhost:6379

# Docker
REDIS_URL=redis://redis:6379
```

### API Configuration

```env
# –ü–æ—Ä—Ç API —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 3000)
API_PORT=3000

# –•–æ—Å—Ç API —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.0.0.0)
API_HOST=0.0.0.0

# –ü—Ä–µ—Ñ–∏–∫—Å –¥–ª—è –≤—Å–µ—Ö API –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: /api)
API_PREFIX=/api
```

### Assets –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

```env
# –ë–∞–∑–æ–≤—ã–π URL –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
ASSETS_BASE_URL=https://botgarden.store/assets

# –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
ASSETS_BASE_URL=http://localhost:3000/assets
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

```env
# API –∫–ª—é—á–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω—Å–∫–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
API_KEYS=admin-key-prod-1,admin-key-prod-2

# –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ Origins –¥–ª—è CORS (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
CORS_ORIGINS=https://botgarden.store,https://admin.botgarden.store

# –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
CORS_ORIGINS=http://localhost:3000,http://localhost:8080
```

### Rate Limiting

```env
# –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 100)
RATE_LIMIT_PUBLIC=100

# –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1000)
RATE_LIMIT_ADMIN=1000
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```env
# TTL –¥–ª—è –∫—ç—à–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 300 = 5 –º–∏–Ω—É—Ç)
REDIS_CACHE_TTL=300

# –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: true)
ENABLE_CACHE=true
```

### Environment

```env
# –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (development/production/test)
NODE_ENV=production

# –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
NODE_ENV=development
```

---

## üîß –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### .env —Ñ–∞–π–ª—ã

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```
.env                    # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
.env.example           # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
.env.local             # –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
.env.production        # Production –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
docker.env.example     # –ü—Ä–∏–º–µ—Ä –¥–ª—è Docker
```

### TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```
tsconfig.json          # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
tsconfig.api.json      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è API
tsconfig.bot.json      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Bot
tsconfig.test.json     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤
```

### Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```
docker-compose.yml     # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
docker-compose.prod.yml # Production –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
Dockerfile.api         # –û–±—Ä–∞–∑ –¥–ª—è API
Dockerfile.bot         # –û–±—Ä–∞–∑ –¥–ª—è Bot
```

---

## üì± –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot

### –ß–µ—Ä–µ–∑ @BotFather

1. **–°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞:**

   ```
   /newbot
   Shawarma Bot
   @YourShawarmaBot
   ```

2. **–û–ø–∏—Å–∞–Ω–∏–µ –±–æ—Ç–∞:**

   ```
   /setdescription @YourShawarmaBot
   –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–æ—Ç –¥–ª—è –∑–∞–∫–∞–∑–∞ —à–∞—É—Ä–º—ã —Å —É–¥–æ–±–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏ –±—ã—Å—Ç—Ä–æ–π –¥–æ—Å—Ç–∞–≤–∫–æ–π
   ```

3. **–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:**

   ```
   /setcommands @YourShawarmaBot
   start - –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
   ```

4. **–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è:**
   ```
   /setuserpic @YourShawarmaBot
   # –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 512x512px
   ```

### Mini App –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```
/newapp @YourShawarmaBot
Shawarma Mini App
https://botgarden.store/miniapp
```

---

## üåê Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```nginx
# Rate limiting zones
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
limit_req_zone $binary_remote_addr zone=general:10m rate=30r/s;

server {
    listen 80;
    server_name botgarden.store botgarden.shop botgarden.tech
                botcraft.tech botgrover.fun botgrover.ru;

    # Security headers
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;

    # API –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ
    location /api/ {
        limit_req zone=api burst=20 nodelay;
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Health check
    location /health {
        proxy_pass http://localhost:3000/api/health;
    }
}
```

### SSL –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```nginx
server {
    listen 443 ssl http2;
    server_name botgarden.store;

    ssl_certificate /etc/letsencrypt/live/botgarden.store/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/botgarden.store/privkey.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
}
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### PostgreSQL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```sql
-- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
shared_preload_libraries = 'pg_stat_statements'
max_connections = 100
shared_buffers = 256MB
effective_cache_size = 1GB
work_mem = 4MB
maintenance_work_mem = 64MB

-- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
log_statement = 'all'
log_duration = on
log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '
```

### –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

```sql
-- –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã
CREATE INDEX idx_orders_user_id_created ON orders(user_id, created_at DESC);
CREATE INDEX idx_cart_items_user_id ON cart_items(user_id);
CREATE INDEX idx_menu_items_category_available ON menu_items(category_id, is_available);
```

---

## üîÑ Redis –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### redis.conf

```conf
# –ü–∞–º—è—Ç—å
maxmemory 256mb
maxmemory-policy allkeys-lru

# Persistence (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
save 900 1
save 300 10
save 60 10000

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
requirepass your_redis_password
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ

```typescript
// –ö–ª—é—á–∏ –∫—ç—à–∞
const CACHE_KEYS = {
  cart: (userId: number) => `cart:${userId}`,
  menu: (category: string) => `menu:${category}`,
  user: (userId: number) => `user:${userId}`,
  stats: () => 'stats:global',
};
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Health Check endpoints

```bash
# –û—Å–Ω–æ–≤–Ω–æ–π health check
curl http://localhost:3000/api/health

# –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
curl http://localhost:3000/api/health/detailed

# Readiness probe (–¥–ª—è Kubernetes)
curl http://localhost:3000/api/health/ready

# Liveness probe (–¥–ª—è Kubernetes)
curl http://localhost:3000/api/health/live
```

### –ú–µ—Ç—Ä–∏–∫–∏

```env
# –í–∫–ª—é—á–µ–Ω–∏–µ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫
ENABLE_METRICS=true

# Prometheus endpoint
METRICS_PORT=9090
```

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### Jest –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```javascript
// jest.config.js
module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'node',
  setupFilesAfterEnv: ['<rootDir>/__tests__/setupJest.ts'],
  testTimeout: 10000,
  collectCoverageFrom: ['src/**/*.ts', '!src/**/*.test.ts', '!src/**/*.spec.ts'],
};
```

### ESLint –∏ Prettier

```json
// .eslintrc.json
{
  "extends": ["@typescript-eslint/recommended", "prettier"],
  "rules": {
    "@typescript-eslint/no-unused-vars": "error",
    "@typescript-eslint/explicit-function-return-type": "warn"
  }
}
```

---

## üöÄ Production –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

```env
NODE_ENV=production
BOT_TOKEN=your_production_token
DATABASE_URL=postgresql://user:secure_password@db:5432/shawarma_db
REDIS_URL=redis://:secure_password@redis:6379

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
API_KEYS=secure-key-1,secure-key-2
CORS_ORIGINS=https://yourdomain.com

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
RATE_LIMIT_PUBLIC=50
RATE_LIMIT_ADMIN=500
REDIS_CACHE_TTL=600
ENABLE_CACHE=true

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=info
ENABLE_ACCESS_LOG=true
```

### Docker Compose Production

```yaml
version: '3.8'
services:
  api:
    restart: unless-stopped
    environment:
      - NODE_ENV=production
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M

  bot:
    restart: unless-stopped
    environment:
      - NODE_ENV=production
    deploy:
      resources:
        limits:
          memory: 256M
        reservations:
          memory: 128M
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
npm run config:validate

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
npm run health:check

# –ü—Ä–æ–≤–µ—Ä–∫–∞ TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
npm run type-check

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
docker-compose config
```

### –°–∫—Ä–∏–ø—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```typescript
// scripts/validate-config.ts
function validateConfig() {
  const required = ['BOT_TOKEN', 'DATABASE_URL'];
  const missing = required.filter(key => !process.env[key]);

  if (missing.length > 0) {
    console.error('Missing required environment variables:', missing);
    process.exit(1);
  }

  console.log('‚úÖ Configuration is valid');
}
```

---

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

- [Deployment Guide](DEPLOYMENT.md) - –¥–µ–ø–ª–æ–π —Å —ç—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- [Monitoring](MONITORING.md) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- [Troubleshooting](TROUBLESHOOTING.md) - —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
